allprojects {
    repositories {
        google()
        jcenter()
        mavenLocal()
        mavenCentral()
    }
    buildscript {
        ext {
            kotlin_version = '1.2.41'
            architecture_components_version = '1.1.1'
            support_library_version = '27.1.1'
            google_play_services_version = '15.0.1'
        }
    }
}

def configDir = new File(rootDir, 'config')

configure(subprojects) {
    apply plugin: 'checkstyle'

    afterEvaluate { project ->
        if (project.plugins.hasPlugin("com.android.library") || project.plugins.hasPlugin("com.android.application")) {
            android {
                lintOptions {
                    disable 'InvalidPackage'
                }
            }
        }
    }

    task checkstyle(type: Checkstyle) {
        configFile = new File(configDir, 'checkstyle.xml')
        configProperties.checkstyleConfigDir = configDir
        source 'src/main/java', 'src/test/java'
        include '**/*.java'
        exclude '**/gen/**'
        classpath = files()

        reports {
            xml.enabled = false
            html.setDestination new File("$project.buildDir/outputs/checkstyle/checkstyle.html")
        }
    }
}

task clean(type: Delete) {
    delete rootProject.buildDir
}
